schema: '2.0'
stages:
  reproduce_table_task_1_cbow:
    cmd: cd external/table_repo && docker-compose up --build task_1_cbow
    deps:
    - path: external/table_repo/Dockerfile
      md5: 26c223d7a6c6a04eb18916336607ad51
      size: 546
    - path: external/table_repo/configurations
      md5: c3aa73aac796babc9dbf660b6ddb1aa6.dir
      size: 15354
      nfiles: 6
    - path: external/table_repo/data
      md5: eb7944c72c0939f4870d5998d7f2ca73.dir
      size: 6445664
      nfiles: 10
    - path: external/table_repo/docker-compose.yml
      md5: a0d4357c2b85b66a4cc8aefb25def8ac
      size: 640
    - path: external/table_repo/src
      md5: 72ac4ddfef275e17fe54016059a24a28.dir
      size: 67895
      nfiles: 7
    outs:
    - path: external/table_repo/exp1/cbow_finetune_0_lr_0.0003_schedule_none_epoch_10_feature_edit-context_extra_0_seed_1
      md5: 1fc77a1a8328fcde6900e0435953dde6.dir
      size: 21417222
      nfiles: 7
    - path: external/table_repo/exp1/cbow_finetune_0_lr_0.0003_schedule_none_epoch_10_feature_edit-original_extra_0_seed_1
      md5: 3247aaef3094b0bc24b1185edb9b0fa3.dir
      size: 21417147
      nfiles: 7
    - path: external/table_repo/exp1/cbow_finetune_0_lr_0.0003_schedule_none_epoch_10_feature_edit-original_extra_1_seed_1
      md5: f27622452c122a783dea17cb5fe6dcb0.dir
      size: 21416839
      nfiles: 7
    - path: external/table_repo/exp1/cbow_finetune_0_lr_0.001_schedule_none_epoch_10_feature_edit-context_extra_1_seed_1
      md5: 46757fb68fd3a1b17bde4b10fb7bdeba.dir
      size: 21417007
      nfiles: 7
    - path: external/table_repo/exp1/cbow_finetune_1_lr_0.0003_schedule_none_epoch_10_feature_edit-context_extra_0_seed_1
      md5: 5c4e78b965548965966dec773c1a8ca3.dir
      size: 21416992
      nfiles: 7
    - path: external/table_repo/exp1/cbow_finetune_1_lr_0.0003_schedule_none_epoch_10_feature_edit-context_extra_1_seed_1
      md5: 16b4016fe3816dd98d5e930a6407b41a.dir
      size: 21416902
      nfiles: 7
    - path: external/table_repo/exp1/cbow_finetune_1_lr_0.001_schedule_none_epoch_10_feature_edit-original_extra_0_seed_1
      md5: af32956fc3d682860a19581fe1c2e004.dir
      size: 21416921
      nfiles: 7
    - path: external/table_repo/exp1/cbow_finetune_1_lr_0.001_schedule_none_epoch_10_feature_edit-original_extra_1_seed_1
      md5: 335fc57b3b51a9738eecd4200e1e4950.dir
      size: 21416930
      nfiles: 7
  download_data:
    cmd: python3 laughing_net/data/download.py
    deps:
    - path: laughing_net/data/download.py
      md5: 1d89869725a2d26d227fbde48195c7b8
      size: 622
    params:
      params.yaml:
        data.url: https://zenodo.org/record/3969509/files/semeval-2020-task-7-dataset.zip
        data.zip_file: semeval-2020-task-7-dataset.zip
    outs:
    - path: data/raw/semeval-2020-task-7-dataset
      md5: 1f1dfa45b0bb665ce7927b1d59427163.dir
      size: 5717613
      nfiles: 14
    - path: data/raw/semeval-2020-task-7-dataset.zip
      md5: 9953e94c4dc7e50d68b010d68a143f9c
      size: 1621456
  substitute_replacements_task_1_train:
    cmd: python3 laughing_net/features/substitute_replacements.py --input data/raw/semeval-2020-task-7-dataset/subtask-1/train.csv
      --output data/interim/task-1/train_sub.csv
    deps:
    - path: data/raw/semeval-2020-task-7-dataset/subtask-1/train.csv
      md5: aeff8a77a3bb1ed5abfcd1483edd329c
      size: 947914
    - path: laughing_net/features/substitute_replacements.py
      md5: 9213c1c821af2bc56a8c922dfbf150b0
      size: 999
    outs:
    - path: data/interim/task-1/train_sub.csv
      md5: 80707d1f7ad2560f90a407c7cd6c6e2a
      size: 784928
  substitute_replacements_task_1_dev:
    cmd: python3 laughing_net/features/substitute_replacements.py --input data/raw/semeval-2020-task-7-dataset/subtask-1/dev.csv
      --output data/interim/task-1/dev_sub.csv
    deps:
    - path: data/raw/semeval-2020-task-7-dataset/subtask-1/dev.csv
      md5: 2b231590dec5dd304e1aadf2ee8b1f34
      size: 241339
    - path: laughing_net/features/substitute_replacements.py
      md5: 9213c1c821af2bc56a8c922dfbf150b0
      size: 999
    outs:
    - path: data/interim/task-1/dev_sub.csv
      md5: 503dc1d67554108170b5c0e3949a42b0
      size: 200379
  substitute_replacements_task_1_test:
    cmd: python3 laughing_net/features/substitute_replacements.py --input data/raw/semeval-2020-task-7-dataset/subtask-1/test.csv
      --output data/interim/task-1/test_sub.csv
    deps:
    - path: data/raw/semeval-2020-task-7-dataset/subtask-1/test.csv
      md5: b59003d5f012914d3ef971fead9296e2
      size: 297352
    - path: laughing_net/features/substitute_replacements.py
      md5: 9213c1c821af2bc56a8c922dfbf150b0
      size: 999
    outs:
    - path: data/interim/task-1/test_sub.csv
      md5: 4684dec550815be206f8575a4af34abc
      size: 246201
  tfidf_task_1_train:
    cmd: python3 laughing_net/features/tfidf.py --input data/interim/task-1/train_sub.csv
      --output data/interim/task-1/train_tfidf.npz --encoder artifacts/tfidf_encoder.pkl
      --fit
    deps:
    - path: data/interim/task-1/train_sub.csv
      md5: 80707d1f7ad2560f90a407c7cd6c6e2a
      size: 784928
    - path: laughing_net/features/tfidf.py
      md5: 45a7dea045f6528e7122c414061dfa37
      size: 1474
    outs:
    - path: artifacts/tfidf_encoder.pkl
      md5: 7e37ea252ae95ab097374d16158bb5c2
      size: 143182
    - path: data/interim/task-1/train_tfidf.npz
      md5: 1d9921e6376ae998ba782128e222811c
      size: 354643
  tfidf_task_1_dev:
    cmd: python3 laughing_net/features/tfidf.py --input data/interim/task-1/dev_sub.csv
      --output data/interim/task-1/dev_tfidf.npz --encoder artifacts/tfidf_encoder.pkl
    deps:
    - path: artifacts/tfidf_encoder.pkl
      md5: 7e37ea252ae95ab097374d16158bb5c2
      size: 143182
    - path: data/interim/task-1/dev_sub.csv
      md5: 503dc1d67554108170b5c0e3949a42b0
      size: 200379
    - path: laughing_net/features/tfidf.py
      md5: 45a7dea045f6528e7122c414061dfa37
      size: 1474
    outs:
    - path: data/interim/task-1/dev_tfidf.npz
      md5: 0f046c86635239adfc407e05bf96992f
      size: 77656
  tfidf_task_1_test:
    cmd: python3 laughing_net/features/tfidf.py --input data/interim/task-1/test_sub.csv
      --output data/interim/task-1/test_tfidf.npz --encoder artifacts/tfidf_encoder.pkl
    deps:
    - path: artifacts/tfidf_encoder.pkl
      md5: 7e37ea252ae95ab097374d16158bb5c2
      size: 143182
    - path: data/interim/task-1/test_sub.csv
      md5: 4684dec550815be206f8575a4af34abc
      size: 246201
    - path: laughing_net/features/tfidf.py
      md5: 45a7dea045f6528e7122c414061dfa37
      size: 1474
    outs:
    - path: data/interim/task-1/test_tfidf.npz
      md5: 662b75076a5420d09f2b49942a71514d
      size: 94037
